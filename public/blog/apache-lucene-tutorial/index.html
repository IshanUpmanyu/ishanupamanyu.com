<!DOCTYPE html>
<html>

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width">
<link rel="icon" href=/fav.png type="image/gif">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      media="print" onload="this.media='all'" />
<noscript>
  <link
          href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
          rel="stylesheet">
</noscript>


<link rel="stylesheet" href="/css/font.css" media="all">



<meta property="og:title" content="Apache Lucene Tutorial - A simple guide to getting started in 2022" />
<meta property="og:description" content="Apache Lucene is a full-text search library written in Java. Lucene is a top-level Apache Project. and was written in 1999 by Doug Cutting.
This is the only Apache Lucene tutorial you will need to get started with Lucene in 2022. We will first go over the basic concepts of Apache Lucene. Then we will try and explore the Lucene API. At last, we will end this tutorial by building a search application that indexes and searches files on our local file system." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/blog/apache-lucene-tutorial/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2022-04-01T20:38:55+05:30" />
<meta property="article:modified_time" content="2022-04-01T20:38:55+05:30" /><meta property="og:site_name" content="Ishan Upamanyu&#39;s Blog" />

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Apache Lucene Tutorial - A simple guide to getting started in 2022"/>
<meta name="twitter:description" content="Apache Lucene is a full-text search library written in Java. Lucene is a top-level Apache Project. and was written in 1999 by Doug Cutting.
This is the only Apache Lucene tutorial you will need to get started with Lucene in 2022. We will first go over the basic concepts of Apache Lucene. Then we will try and explore the Lucene API. At last, we will end this tutorial by building a search application that indexes and searches files on our local file system."/>


<link rel="stylesheet" href="/bootstrap-5/css/bootstrap.min.css" media="all"><link rel="stylesheet" href="/css/header.css" media="all">
<link rel="stylesheet" href="/css/footer.css" media="all">


<link rel="stylesheet" href="/css/theme.css" media="all">




<style>
    :root {
        --text-color: #F5F5F5;
        --text-secondary-color: #F5F5F5;
        --background-color: #313552;
        --secondary-background-color: #64ffda1a;
        --primary-color: #F1E0AC;
        --secondary-color: #30475E;

         
        --text-color-dark: #e4e6eb;
        --text-secondary-color-dark: #b0b3b8;
        --background-color-dark: #18191a;
        --secondary-background-color-dark: #212529;
        --primary-color-dark: #ffffff;
        --secondary-color-dark: #212529;
    }
    body {
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        text-align: left;
    }

    html {
        background-color: var(--background-color) !important;
    }

    body::-webkit-scrollbar {
        height: 0px;
        width: 8px;
        background-color: var(--background-color);
    }
    
    ::-webkit-scrollbar-track {
        border-radius: 1rem;
    }
    
    ::-webkit-scrollbar-thumb {
        border-radius: 1rem;
        background: #b0b0b0;
        outline: 1px solid var(--background-color);
    }

    #search-content::-webkit-scrollbar {
        width: .5em;
        height: .1em;
        background-color: var(--background-color);
    }
</style>


<meta name="description" content="">
<link rel="stylesheet" href="/css/single.css">


<script defer src="/fontawesome-6/all-6.4.2.js"></script>

  <title>
Apache Lucene Tutorial - A simple guide to getting started in 2022 | Ishan&#39;s Blog

  </title>
</head>

<body class="light">
  
  
<script>
    let localStorageValue = localStorage.getItem("pref-theme");
    let mediaQuery = window.matchMedia('(prefers-color-scheme: dark)').matches;

    switch (localStorageValue) {
        case "dark":
            document.body.classList.add('dark');
            break;
        case "light":
            document.body.classList.remove('dark');
            break;
        default:
            if (mediaQuery) {
                document.body.classList.add('dark');
            }
            break;
    }
</script>




<script>
    var prevScrollPos = window.pageYOffset;
    window.addEventListener("scroll", function showHeaderOnScroll() {
        let profileHeaderElem = document.getElementById("profileHeader");
        let currentScrollPos = window.pageYOffset;
        let resetHeaderStyle = false;
        let showNavBarOnScrollUp =  true ;
        let showNavBar = showNavBarOnScrollUp ? prevScrollPos > currentScrollPos : currentScrollPos > 0;
        if (showNavBar) {
            profileHeaderElem.classList.add("showHeaderOnTop");
        } else {
            resetHeaderStyle = true;
        }
        if(currentScrollPos === 0) {
            resetHeaderStyle = true;
        }
        if(resetHeaderStyle) {
            profileHeaderElem.classList.remove("showHeaderOnTop");
        }
        prevScrollPos = currentScrollPos;        
    });
</script>



<header id="profileHeader">
    <nav class="pt-3 navbar navbar-expand-lg animate">
        <div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5">
            
            <a class="navbar-brand primary-font text-wrap" href="/">
                
                <img src="/fav.png" width="30" height="30"
                    class="d-inline-block align-top">
                Ishan Upamanyu
                
            </a>

            
                <div>
                    <input id="search" autocomplete="off" class="form-control mr-sm-2 d-none d-md-block" placeholder='Ctrl &#43; k to Search...'
                        aria-label="Search" oninput="searchOnChange(event)">
                </div>
            

            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true">
                    <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"></path>
                </svg>
            </button>

            
            <div class="collapse navbar-collapse text-wrap primary-font" id="navbarContent">
                <ul class="navbar-nav ms-auto text-center">
                    
                        <li class="nav-item navbar-text d-block d-md-none">
                            <div class="nav-link">
                                <input id="search" autocomplete="off" class="form-control mr-sm-2" placeholder='Ctrl &#43; k to Search...' aria-label="Search" oninput="searchOnChange(event)">
                            </div>
                        </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#about" aria-label="about">
                            About Me
                        </a>
                    </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#experience"
                            aria-label="experience">
                            Experience
                        </a>
                    </li>
                    

                    

                    

                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#contact"
                            aria-label="contact">
                            Contact
                        </a>
                    </li>
                    

                    
                    
                    
                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/blog" title="Blog posts">
                            
                            Blog
                        </a>
                    </li>
                    
                    

                    

                </ul>

            </div>
        </div>
    </nav>
</header>
<div id="content">
<section id="single">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-sm-12 col-md-12 col-lg-9">
        <div class="pr-lg-4">
          <div class="title mb-5">
            <h1 class="text-center mb-4">Apache Lucene Tutorial - A simple guide to getting started in 2022</h1>
            <div class="text-center">
              Ishan Upamanyu 
              <small>|</small>
              Apr 1, 2022

              
              <span id="readingTime">
                min read
              </span>
              
            </div>
          </div>
          
          <div class="featured-image">
            <img class="img-fluid mx-auto d-block" src="/uploads/2022/01/Apache-Lucene-1-e1648997525598.jpeg" alt="Apache Lucene Tutorial - A simple guide to getting started in 2022">
          </div>
          
          <article class="page-content  p-2">
          <p>Apache Lucene is a full-text search library written in Java. Lucene is a <a href="https://lucene.apache.org/">top-level Apache Project.</a> and was written in 1999 by <a href="https://en.wikipedia.org/wiki/Doug_Cutting">Doug Cutting</a>.</p>
<p>This is the only Apache Lucene tutorial you will need to get started with Lucene in 2022. We will first go over the basic concepts of Apache Lucene. Then we will try and explore the Lucene API. At last, we will end this tutorial by building a search application that indexes and searches files on our local file system. We will be using Lucene 8 in this tutorial which is the current version of Lucene as of early 2022.</p>
<h2 id="introduction">Introduction</h2>
<h3 id="what-is-lucene">What is Lucene?</h3>
<p>Lucene is a full-text search library written in Java. It is a powerful library that forms the core of many Search based technologies like Elasticsearch and Solr. Lucene is very fast. It can help you find a document containing a given word among millions of documents in milliseconds. From searching in milliseconds to indexing speeds of as high as <a href="http://people.apache.org/~mikemccand/lucenebench/indexing.html">700GB per hour</a>, Lucene is a library with very high performance.</p>
<h3 id="history-of-apache-lucene">History of Apache Lucene</h3>
<p>Lucene was first published in 1999 by Doug Cutting. Cutting originally published Lucene on SourceForge. In September 2001 it joined the Jakarta family of software of Apache Software Foundation. In January 2005, it became its own top-level project.</p>
<p>Initially, various other projects like Mahout, Tika, and Nutch were also a part of Lucene. Later they got separated into their own top-level Apache Products.</p>
<h3 id="lucene-vs-solr-and-elasticsearch">Lucene vs Solr and Elasticsearch</h3>
<p>While Lucene is just a java library, Elasticsearch and Solr are full-fledged search servers. You can imagine the difference between Lucene being the engine and Elasticsearch being a Ferrari and Solr being a Lamborgini.</p>
<p>With Lucene, you get the core capabilities of performing the search but Elasticsearch and Solr add features to it like providing an HTTP interface to Lucene-based search, automatically managing the performance by using distributed computing on top of Lucene, and many other features.</p>
<p>Now that you understand what Lucene is we will begin this Lucene tutorial by building a simple java application.</p>
<h2 id="lucene-tutorial--a-simple-java-application">Lucene Tutorial – A simple java application</h2>
<h3 id="adding-dependencies">Adding dependencies</h3>
<p>We need <code>lucene-core </code>dependency to start working with Lucene.</p>
<p>If we want to use query parser we can also include the <code>lucene-queryparser</code> dependency.</p>
<p>In case you want to use any other analyzer than StandardAnalyzer, you will need to add the <code>lucene-analyzers-common</code> dependency too.</p>
<p>In case of using MAVEN, you can paste the following dependencies in <code>pom.xml</code></p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>  <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.lucene<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>  <span style="color:#f92672">&lt;artifactId&gt;</span>lucene-core<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>  <span style="color:#f92672">&lt;version&gt;</span>8.10.1<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>  <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.lucene<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>  <span style="color:#f92672">&lt;artifactId&gt;</span>lucene-queryparser<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>  <span style="color:#f92672">&lt;version&gt;</span>8.10.1<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>  <span style="color:#f92672">&lt;groupId&gt;</span>org.apache.lucene<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>  <span style="color:#f92672">&lt;artifactId&gt;</span>lucene-analyzers-common<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>  <span style="color:#f92672">&lt;version&gt;</span>8.10.1<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id="a-simple-indexer">A simple Indexer</h3>
<p>We will create a simple indexer which will add three movies in our lucene index:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#f92672">import</span> org.apache.lucene.analysis.Analyzer;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#f92672">import</span> org.apache.lucene.analysis.standard.StandardAnalyzer;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#f92672">import</span> org.apache.lucene.document.Document;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#f92672">import</span> org.apache.lucene.document.Field;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#f92672">import</span> org.apache.lucene.document.TextField;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#f92672">import</span> org.apache.lucene.index.IndexWriter;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#f92672">import</span> org.apache.lucene.index.IndexWriterConfig;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#f92672">import</span> org.apache.lucene.store.Directory;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#f92672">import</span> org.apache.lucene.store.FSDirectory;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#f92672">import</span> java.io.IOException;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#f92672">import</span> java.nio.file.Paths;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span><span style="color:#75715e"> * This class creates documents for three movie titles and indexes them into lucene.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SimpleIndexer</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">index</span>(String indexPath) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>        <span style="color:#75715e">//We open a File System directory as we want to store the index on our local file system.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>        Directory directory <span style="color:#f92672">=</span> FSDirectory.<span style="color:#a6e22e">open</span>(Paths.<span style="color:#a6e22e">get</span>(indexPath));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>        <span style="color:#75715e">//The analyzer is used to perform analysis on text of documents and create the terms that will be</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>        <span style="color:#75715e">//added in the index.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>        Analyzer analyzer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StandardAnalyzer();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>        IndexWriterConfig indexWriterConfig <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexWriterConfig(analyzer);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>        IndexWriter indexWriter <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexWriter(directory, indexWriterConfig);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>        <span style="color:#75715e">//Now we create three documents for 3 movies. We have only one Field called title in each document.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>        Document movie1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Document();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>        movie1.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> TextField(<span style="color:#e6db74">&#34;title&#34;</span>, <span style="color:#e6db74">&#34;Harry Potter and the Prisoner of Azkaban&#34;</span>, Field.<span style="color:#a6e22e">Store</span>.<span style="color:#a6e22e">YES</span>));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>        Document movie2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Document();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>        movie2.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> TextField(<span style="color:#e6db74">&#34;title&#34;</span>, <span style="color:#e6db74">&#34;Lord of the Rings: The fellowship of the ring.&#34;</span>, Field.<span style="color:#a6e22e">Store</span>.<span style="color:#a6e22e">YES</span>));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>        Document movie3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Document();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>        movie3.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> TextField(<span style="color:#e6db74">&#34;title&#34;</span>, <span style="color:#e6db74">&#34;Toy Story 3&#34;</span>, Field.<span style="color:#a6e22e">Store</span>.<span style="color:#a6e22e">YES</span>));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Going to index 3 movies.&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>        <span style="color:#75715e">//Now we add the three documents to our index.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span>        indexWriter.<span style="color:#a6e22e">addDocument</span>(movie1);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>        indexWriter.<span style="color:#a6e22e">addDocument</span>(movie2);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span>        indexWriter.<span style="color:#a6e22e">addDocument</span>(movie3);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Movies Indexed Successfully!&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span>        indexWriter.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span>        String path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;moviesIndex&#34;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span>        SimpleIndexer indexer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SimpleIndexer();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span>        indexer.<span style="color:#a6e22e">index</span>(path);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span>}
</span></span></code></pre></div><p><strong>OUTPUT</strong>:</p>
<pre tabindex="0"><code>Going to index 3 movies.
Movies Indexed Successfully!
</code></pre><h3 id="a-simple-searcher">A simple Searcher</h3>
<p>Then we create a simple searcher which will try to find a movie by title. It will return how many documents it found with matching titles and then print the title of the movie found.</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#f92672">import</span> org.apache.lucene.analysis.Analyzer;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#f92672">import</span> org.apache.lucene.analysis.standard.StandardAnalyzer;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#f92672">import</span> org.apache.lucene.document.Document;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#f92672">import</span> org.apache.lucene.index.DirectoryReader;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#f92672">import</span> org.apache.lucene.index.IndexReader;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#f92672">import</span> org.apache.lucene.queryparser.classic.ParseException;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#f92672">import</span> org.apache.lucene.queryparser.classic.QueryParser;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#f92672">import</span> org.apache.lucene.search.IndexSearcher;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#f92672">import</span> org.apache.lucene.search.Query;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#f92672">import</span> org.apache.lucene.search.ScoreDoc;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#f92672">import</span> org.apache.lucene.search.TopDocs;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#f92672">import</span> org.apache.lucene.store.FSDirectory;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span><span style="color:#f92672">import</span> java.io.IOException;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span><span style="color:#f92672">import</span> java.nio.file.Paths;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span><span style="color:#75715e"> * The class looks up a movie in the movies index created by {@SimpleIndexer}
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SimpleSearcher</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">search</span>(String indexPath, String title) <span style="color:#66d9ef">throws</span> IOException, ParseException {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>        <span style="color:#75715e">//We need to open an IndexReader to read the lucene index stored at given indexPath</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>        IndexReader indexReader <span style="color:#f92672">=</span> DirectoryReader.<span style="color:#a6e22e">open</span>(FSDirectory.<span style="color:#a6e22e">open</span>(Paths.<span style="color:#a6e22e">get</span>(indexPath)));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>        <span style="color:#75715e">//IndexSearcher will help us query the index</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>        IndexSearcher indexSearcher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexSearcher(indexReader);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>        <span style="color:#75715e">//We will use standard analyzer while we parse our query.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>        Analyzer analyzer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StandardAnalyzer();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>        <span style="color:#75715e">//This query parser will search in title field by default if no field is specified.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>        <span style="color:#75715e">//Also, this will use our Standard analyzer to create terms for the query.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>        QueryParser queryParser <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> QueryParser(<span style="color:#e6db74">&#34;title&#34;</span>, analyzer);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>        <span style="color:#75715e">//We pass in the title as it is to the query parser.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>        <span style="color:#75715e">// This will create a term query for us on the terms in our title.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>        Query query <span style="color:#f92672">=</span> queryParser.<span style="color:#a6e22e">parse</span>(title);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>        <span style="color:#75715e">//We perform the search and get top 10 search results.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>        TopDocs topDocs <span style="color:#f92672">=</span> indexSearcher.<span style="color:#a6e22e">search</span>(query, 10);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>        <span style="color:#75715e">//Print the count of matching documents.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span>        <span style="color:#66d9ef">long</span> totalHits <span style="color:#f92672">=</span> topDocs.<span style="color:#a6e22e">totalHits</span>.<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(String.<span style="color:#a6e22e">format</span>(<span style="color:#e6db74">&#34;Found %d hits.&#34;</span>, totalHits));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>        <span style="color:#75715e">//Print the title field of each matching movie</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>        ScoreDoc<span style="color:#f92672">[]</span> results  <span style="color:#f92672">=</span> topDocs.<span style="color:#a6e22e">scoreDocs</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span>        <span style="color:#66d9ef">for</span>(ScoreDoc scoreDoc: results){
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51</span><span>            <span style="color:#75715e">//Returns the id of the document matching the query</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52</span><span>            <span style="color:#66d9ef">int</span> docId <span style="color:#f92672">=</span> scoreDoc.<span style="color:#a6e22e">doc</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53</span><span>            <span style="color:#66d9ef">float</span> score <span style="color:#f92672">=</span> scoreDoc.<span style="color:#a6e22e">score</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55</span><span>            <span style="color:#75715e">//We fetch the complete document from index via its id</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56</span><span>            Document movie <span style="color:#f92672">=</span> indexSearcher.<span style="color:#a6e22e">doc</span>(docId);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58</span><span>            <span style="color:#75715e">//Now we print the title of the movie</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59</span><span>            System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(String.<span style="color:#a6e22e">format</span>(<span style="color:#e6db74">&#34;Found: %s&#34;</span>, movie.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;title&#34;</span>)));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60</span><span>        }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63</span><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> IOException, ParseException {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64</span><span>        String path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;moviesIndex&#34;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65</span><span>        SimpleSearcher searcher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SimpleSearcher();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66</span><span>        searcher.<span style="color:#a6e22e">search</span>(path, <span style="color:#e6db74">&#34;Harry Potter&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67</span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68</span><span>}
</span></span></code></pre></div><p><strong>OUTPUT</strong>:</p>
<pre tabindex="0"><code>Found 1 hits.
Found: Harry Potter and the Prisoner of Azkaban
</code></pre><p>Before we try and understand our code we need to understand some core terminologies.</p>
<h2 id="core-terminologies">Core terminologies</h2>
<p>We will start this Lucene tutorial with a few core terminologies. These will help you understand how to work with Lucene.</p>
<h3 id="index">Index</h3>
<p>All the documents of similar types are stored in an index. An index can be thought of as a collection. Let’s say you want to search on all articles on Wikipedia, so you will create an index of Wikipedia articles.</p>
<p>Those coming from relation databases backgrounds can try to think of Lucene like a table. Just as you keep the records of one type in one table, similarly you keep documents of one type in one index.</p>
<p>Internally Lucene uses a data structure known as an inverted index. An inverted index can be thought of as the Glossary section at the end of the book. A Glossary contains words with page numbers at which the word occurs. Similarly, an inverted index is made up of a mapping of words to the list of documents that contains that word. To understand how an inverted index works, I suggest you check out <a href="/blog/inverted-index-data-structure/">this article.</a></p>
<h3 id="documents">Documents</h3>
<p>A document is the basic unit of search in Lucene. When you do a search in Lucene, the response is the id of the document.</p>
<p>Database users can think of a document as a record in a table.</p>
<p>A document is a collection of fields.</p>
<h3 id="fields">Fields</h3>
<p>The field is the subunit of a document. You can think of it as an attribute of a document.</p>
<p>Let us say you have a blog and you want to implement a search interface for your blog using Lucene. Each of your blog posts will be a document in the blog-articles index. On each document, you can have multiple fields like a field for title, a field for the body, a field for publishing date, and a field for the author.</p>
<p>Lucene supports searching for documents by fields. For eg in the blogging example, you can search for all articles written by Ishan. Or you can find all articles that contain the word <em>Apple</em> in the title.</p>
<h3 id="analysis">Analysis</h3>
<p>The analysis is the process of splitting up text into tokens. These tokens can be single words or they can be a group of words. Each token gets added to the inverted index. When you search in Lucene, Lucene analyses your text and tries to create tokens for it. Then it searches for those tokens in the inverted index.</p>
<p>The analysis is a very important part of Lucene as it can make or break your search experience. The tokens generated at the analysis step while indexing should match the ones generated in the search time analysis of the query. If they do not, then you won’t see correct search results. To understand the analysis process in-depth, check out the article on the analysis here.</p>
<h2 id="lucene-indexing-api">Lucene Indexing API</h2>
<p>It’s time to understand the Lucene APIs. We begin by looking at some of the core classes that make up the indexing API</p>
<h3 id="directory">Directory</h3>
<p>A <code>Directory</code> interface abstracts the details of how the index is stored. We have the option of storing the index in local file system, virtual memory or on network drive and even on the heap space on RAM . Given the different places where an index can live, Lucene needs to abstract that detail. This is what is achieved with the <code>Directory</code> interface.</p>
<p>Some of the concrete implementations of the <code>Directory</code> interface are:</p>
<ul>
<li><code>BytesBufferDirectory</code>: A ByteBuffer-based Directory implementation that can be used to store index files on the heap.</li>
<li><code>NMapDirectory</code>: uses memory-mapped IO when reading. This is a good choice if you have plenty of virtual memory relative to your index size, eg if you are running on a 64 bit JRE, or you are running on a 32 bit JRE but your index sizes are small enough to fit into the virtual memory space.</li>
<li><code>NIOFSDirectory</code>: uses java.nio’s FileChannel’s positional io when reading to avoid synchronization when reading from the same file.</li>
</ul>
<p>It is suggested to use a File System based directory if you want your index to persist even after your application shuts down. Lucene provides a very helpful <code>FSDirectory.open</code> method that automatically selects the best <code>FSDirectory</code> implementation for your operating system.</p>
<p>The following code ilustrates how to create a directory that is stored on local file system in a temporary directory called “tempIndex”.</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>Path indexPath <span style="color:#f92672">=</span> Files.<span style="color:#a6e22e">createTempDirectory</span>(<span style="color:#e6db74">&#34;tempIndex&#34;</span>);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>Directory directory <span style="color:#f92672">=</span> FSDirectory.<span style="color:#a6e22e">open</span>(indexPath);
</span></span></code></pre></div><h3 id="field">Field</h3>
<p>A Field is an attribute of a document. Think of this like column value in databases.</p>
<p>A field can be of multiple type depending upon the data type of data we want to store. Lucene comes with many prebuilt field classes. Some of the noteworthy classes are:</p>
<ul>
<li>TextField: Use this field type if you want to store some text on which you want full text search capabilites</li>
<li>StringField: Use this when you want to do exact search on the string.</li>
<li>IntPoint: Use this when you want to add an integer data</li>
</ul>
<p>Some of the available subclasses of Field are <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/BinaryDocValuesField.html">BinaryDocValuesField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/BinaryPoint.html">BinaryPoint</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/DoubleDocValuesField.html">DoubleDocValuesField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/DoublePoint.html">DoublePoint</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/DoubleRange.html">DoubleRange</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/FeatureField.html">FeatureField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/Field.html">Field</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/FloatDocValuesField.html">FloatDocValuesField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/FloatPoint.html">FloatPoint</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/FloatRange.html">FloatRange</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/IntPoint.html">IntPoint</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/IntRange.html">IntRange</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/LatLonDocValuesField.html">LatLonDocValuesField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/LatLonPoint.html">LatLonPoint</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/LongPoint.html">LongPoint</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/LongRange.html">LongRange</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/NumericDocValuesField.html">NumericDocValuesField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/SortedDocValuesField.html">SortedDocValuesField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/SortedNumericDocValuesField.html">SortedNumericDocValuesField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/SortedSetDocValuesField.html">SortedSetDocValuesField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/StoredField.html">StoredField</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/codecs/StoredFieldsWriter.MergeVisitor.html">StoredFieldsWriter.MergeVisitor</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/StringField.html">StringField</a>, and <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/document/TextField.html">TextField</a></p>
<p>You can create a Field as:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>Field f <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TextField(<span style="color:#e6db74">&#34;title&#34;</span>, <span style="color:#e6db74">&#34;As you like It&#34;</span>, Field.<span style="color:#a6e22e">Store</span>.<span style="color:#a6e22e">YES</span>);
</span></span></code></pre></div><h3 id="document">Document</h3>
<p>A document is a collection of Fields. You can have a document for one entity. Every attribute of that entity will be the fields on the document. For eg, if you are creating an index of blog posts, you can create a document for each blog post and there will be seperate fields in that document for title, body, author and creation date.</p>
<p>Here is a sample code which creates a document and adds some fields to it.</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>Document doc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Document();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>doc.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> TextField(<span style="color:#e6db74">&#34;title&#34;</span>, <span style="color:#e6db74">&#34;Timon and Pumba&#34;</span>, Field.<span style="color:#a6e22e">Store</span>.<span style="color:#a6e22e">YES</span>));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>doc.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> TextField(<span style="color:#e6db74">&#34;slogan&#34;</span>, <span style="color:#e6db74">&#34;Hakuna Matata&#34;</span>, Field.<span style="color:#a6e22e">Store</span>.<span style="color:#a6e22e">YES</span>));
</span></span></code></pre></div><h3 id="indexwriter">IndexWriter</h3>
<p>Once we have our document created we need to add it to the Lucene index. <code>IndexWriter</code> helps us add our document to the actual Lucene index.</p>
<p>An IndexWriter need and <code>IndexWriterConfig</code> and a <code>Directory</code> instance. The Directory tells the IndexWriter how to store the index. The IndexWriterConfig can be used to set various configurations on the IndexWriter like whether you want to append to the index or rewrite it completely, or it can be used to specify the standard analyzer that you want to use and much more.</p>
<p>You can add a document to the index as:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>Directory dir <span style="color:#f92672">=</span> FSDirectory.<span style="color:#a6e22e">open</span>(Paths.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;index&#34;</span>));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>IndexWriterConfig config <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexWriterConfig();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>IndexWriter writer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexWriter(dir, config);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>writer.<span style="color:#a6e22e">addDocument</span>(doc);
</span></span></code></pre></div><h3 id="analyzer">Analyzer</h3>
<p>An <code>Analyzer</code> is responsible for converting the text added in document to tokens that can be added to our index. Lucene comes with some prebuilt analyzers that you can use.</p>
<p>The most commonly used Analyzer for English language is <code>StandardAnalyzer</code>. This analyzer does the following:</p>
<ol>
<li>splits the text using Word Break rules from the Unicode Text Segmentation algorithm, as specified in <a href="http://unicode.org/reports/tr29/">Unicode Standard Annex #29</a>.</li>
<li>converts the tokens to lowercase and removes common words like a, an, the etc knwon as stop words.</li>
<li>convert the words to base form. For eg <em>drinking</em> will be converted to <em>drink</em>. This enables searches with term <em>drink</em> to match the document containing <em>drinking</em> as well.</li>
</ol>
<p>You can set an analyzer on the IndexWriter as:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>Directory dir <span style="color:#f92672">=</span> FSDirectory.<span style="color:#a6e22e">open</span>(Paths.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;index&#34;</span>));
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>Analyzer analyzer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StandardAnalyzer();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>IndexWriterConfig config <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexWriterConfig(analyzer);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>IndexWriter writer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexWriter(dir, config);
</span></span></code></pre></div><h2 id="lucene-search-api">Lucene Search API</h2>
<p>Now that we are familiar with the indexig API, let’s dive right in to the juicy stuff – the search API.</p>
<h3 id="query">Query</h3>
<p>The <code>Query</code> class is the base class for all the types of queries in Lucene. Lucene supports searching for documents in the index based on the types of queries you use. Some of the common query subclasses are:</p>
<ol>
<li><code>TermQuery</code>: When you know the token you want to find in the index, you need to use the term query. This will return all the documents that contain the term. Please note that the term must be similar to the one produced after analysis.</li>
<li><code>PhraseQuery</code>: A term query can only lookup based on individual terms. Sometimes you want to search for words that occur together. Such words are called as a prhase and you can use a <code>PhraseQuery</code> to search for a phrase.</li>
</ol>
<p>Some of the other query types are:</p>
<p><a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/BlendedTermQuery.html">BlendedTermQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/BooleanQuery.html">BooleanQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/BoostQuery.html">BoostQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/ConstantScoreQuery.html">ConstantScoreQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/DisjunctionMaxQuery.html">DisjunctionMaxQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/DocValuesFieldExistsQuery.html">DocValuesFieldExistsQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/IndexOrDocValuesQuery.html">IndexOrDocValuesQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/MatchAllDocsQuery.html">MatchAllDocsQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/MatchNoDocsQuery.html">MatchNoDocsQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/MultiPhraseQuery.html">MultiPhraseQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/MultiTermQuery.html">MultiTermQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/NGramPhraseQuery.html">NGramPhraseQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/NormsFieldExistsQuery.html">NormsFieldExistsQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/PointInSetQuery.html">PointInSetQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/PointRangeQuery.html">PointRangeQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/spans/SpanQuery.html">SpanQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/SynonymQuery.html">SynonymQuery</a>, <a href="https://lucene.apache.org/core/8_1_1/core/org/apache/lucene/search/TermInSetQuery.html">TermInSetQuery</a></p>
<p>The following code creates a query to lookup the word <em>panda</em> in the <em>body</em> field.</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>Query query <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TermQuery(<span style="color:#66d9ef">new</span> Term(<span style="color:#e6db74">&#34;body&#34;</span>, <span style="color:#e6db74">&#34;panda&#34;</span>));
</span></span></code></pre></div><h3 id="query-parser">Query Parser</h3>
<p>Creating <code>Query</code> objects is powerful was to do search, but it is quiet verbose. You need to write all the java code. There is an easier ways to create <code>Query</code> object. Lucene comes with a very good query parser. Using a query parse you can write queries as normal text and use the <code>QueryParser</code> to create a Query object for you.</p>
<p>For e.g. To create a query to lookup the word <em>panda</em> in the <em>body</em> field using QueryParser use the following code:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>Analyzer analyzer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StandardAnalyzer();
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>QueryParser parser <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> QueryParser(<span style="color:#e6db74">&#34;body&#34;</span>, analyzer);
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>Query query <span style="color:#f92672">=</span> parser.<span style="color:#a6e22e">parse</span>(<span style="color:#e6db74">&#34;body:panda&#34;</span>);
</span></span></code></pre></div><p>Note here that we needed to pass an <code>Analyzer</code> to <code>QueryParser</code>. Lucene will use the passed analyzer to create the terms it needs to lookup. This query time analysis is critcal in the sense that it should produce the same terms that were added to the index at index time. If not done properly you might not see results correctly.</p>
<p><a href="https://lucene.apache.org/core/2_9_4/queryparsersyntax.html">Here</a> is the detailed query parser syntax available. I encourage you to read it and give it a try.</p>
<h3 id="indexreader">IndexReader</h3>
<p>Just as we used an <code>IndexWriter</code> to add documents to the index, we need to use a <code>IndexReader</code> to read our index. An <code>IndexReader</code> provides low level API that can be used to interact directly with the Lucene index.</p>
<p>An <code>IndexReader</code> provides an interface for accessing a point-in-time view of an index. That is it will only show changes as were available at the time the reader was opened. Any other changes made after opening the <code>IndexReader</code> won’t be visible.</p>
<p>You can create an <code>IndexReader</code> as:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>String indexPath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/tmp/myIndex&#34;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>IndexReader reader <span style="color:#f92672">=</span> DirectoryReader.<span style="color:#a6e22e">open</span>(FSDirectory.<span style="color:#a6e22e">open</span>(Paths.<span style="color:#a6e22e">get</span>(indexPath)));
</span></span></code></pre></div><h3 id="indexsearcher">IndexSearcher</h3>
<p>While an IndexReader provides a low level API to read the internals of the index, IndexSearcher exposes the high level search API. An IndexSearcher can be created by passing in an IndexReader as:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>IndexSearcher searcher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexSearcher(reader);
</span></span></code></pre></div><p>You can then use the IndexSearcher to get top 10 documents in the index that match a query as:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>TopDocs topDocs <span style="color:#f92672">=</span> indexSearcher.<span style="color:#a6e22e">search</span>(query, 10);
</span></span></code></pre></div><h3 id="topdocs">TopDocs</h3>
<p>The output of seach via IndexSearcer is a TopDocs instance. TopDocs contains the total number of documents that matched the query (TopDocs) and an array of search results ( Called ScoreDoc[]). The results are by default sorted by the score with the best matching result coming first and least matching result coming last. You can get these as:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#66d9ef">long</span> totalHits <span style="color:#f92672">=</span> topDocs.<span style="color:#a6e22e">totalHits</span>.<span style="color:#a6e22e">value</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>ScoreDoc<span style="color:#f92672">[]</span> results  <span style="color:#f92672">=</span> topDocs.<span style="color:#a6e22e">scoreDocs</span>;
</span></span></code></pre></div><h3 id="scoredoc">ScoreDoc</h3>
<p>A ScoreDoc contains the id of the document along with its score. Note that this only contains the id of the document and not the complete document. So if you want the complete document you can get that as:</p>
<div class="highlight my-class" id="my-codeblock"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#66d9ef">int</span> docId <span style="color:#f92672">=</span> scoreDoc.<span style="color:#a6e22e">doc</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#66d9ef">float</span> score <span style="color:#f92672">=</span> scoreDoc.<span style="color:#a6e22e">score</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>Document doc <span style="color:#f92672">=</span> indexSearcher.<span style="color:#a6e22e">doc</span>(docId);
</span></span></code></pre></div><p>Once you have a document you can get its individual field values by using the get method on document. However note that you will get a value only if you specified Field.Store.YES while adding the document to the index.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this blog post we covered an in-depth Lucene tutorial. We understood what Lucene is, how it is different from Solr and Elasticsearch. We then made a simple Lucene application in JAVA and then understood some core concepts of lucene. We ended the tutorial by going over the Indexing and Searching API of Lucene. With this knowledge you are ready to create your own Lucene application. If you have any queries let me know in the comments.</p>
<h2 id="what-next">What next?</h2>
<p>Now that you know the basics of Lucene, you might be interested in understanding the concepts in depth. <a href="/blog/apache-lucene-7-concepts-that-will-help-you-get-started/">Here</a> is a great post explaining the 7 concepts you need to understand to start using Lucene.</p>

          </article>
        </div>
      </div>
      <div class="col-sm-12 col-md-12 col-lg-3">
        <div id="stickySideBar" class="sticky-sidebar">
          
          <aside class="toc">
              <h5>
                Table Of Contents
              </h5>
              <div class="toc-content">
                <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#what-is-lucene">What is Lucene?</a></li>
        <li><a href="#history-of-apache-lucene">History of Apache Lucene</a></li>
        <li><a href="#lucene-vs-solr-and-elasticsearch">Lucene vs Solr and Elasticsearch</a></li>
      </ul>
    </li>
    <li><a href="#lucene-tutorial--a-simple-java-application">Lucene Tutorial – A simple java application</a>
      <ul>
        <li><a href="#adding-dependencies">Adding dependencies</a></li>
        <li><a href="#a-simple-indexer">A simple Indexer</a></li>
        <li><a href="#a-simple-searcher">A simple Searcher</a></li>
      </ul>
    </li>
    <li><a href="#core-terminologies">Core terminologies</a>
      <ul>
        <li><a href="#index">Index</a></li>
        <li><a href="#documents">Documents</a></li>
        <li><a href="#fields">Fields</a></li>
        <li><a href="#analysis">Analysis</a></li>
      </ul>
    </li>
    <li><a href="#lucene-indexing-api">Lucene Indexing API</a>
      <ul>
        <li><a href="#directory">Directory</a></li>
        <li><a href="#field">Field</a></li>
        <li><a href="#document">Document</a></li>
        <li><a href="#indexwriter">IndexWriter</a></li>
        <li><a href="#analyzer">Analyzer</a></li>
      </ul>
    </li>
    <li><a href="#lucene-search-api">Lucene Search API</a>
      <ul>
        <li><a href="#query">Query</a></li>
        <li><a href="#query-parser">Query Parser</a></li>
        <li><a href="#indexreader">IndexReader</a></li>
        <li><a href="#indexsearcher">IndexSearcher</a></li>
        <li><a href="#topdocs">TopDocs</a></li>
        <li><a href="#scoredoc">ScoreDoc</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#what-next">What next?</a></li>
  </ul>
</nav>
              </div>
          </aside>
          

          
          <aside class="tags">
            <h5>Tags</h5>
            <ul class="tags-ul list-unstyled list-inline">
              
              <li class="list-inline-item"><a href="http://localhost:1313/tags/apache-lucene" target="_blank">Apache Lucene</a></li>
              
              <li class="list-inline-item"><a href="http://localhost:1313/tags/information-retrieval" target="_blank">Information Retrieval</a></li>
              
            </ul>
          </aside>
          

          
          <aside class="social">
            <h5>Social</h5>
            <div class="social-content">
              <ul class="list-inline">
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2flocalhost%3a1313%2fblog%2fapache-lucene-tutorial%2f">
                    <i class="fab fa-linkedin"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://twitter.com/share?text=Apache%20Lucene%20Tutorial%20-%20A%20simple%20guide%20to%20getting%20started%20in%202022&url=http%3a%2f%2flocalhost%3a1313%2fblog%2fapache-lucene-tutorial%2f">
                    <i class="fab fa-twitter"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://api.whatsapp.com/send?text=Apache%20Lucene%20Tutorial%20-%20A%20simple%20guide%20to%20getting%20started%20in%202022: http%3a%2f%2flocalhost%3a1313%2fblog%2fapache-lucene-tutorial%2f">
                    <i class="fab fa-whatsapp"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href='mailto:?subject=Apache%20Lucene%20Tutorial%20-%20A%20simple%20guide%20to%20getting%20started%20in%202022&amp;body=Check%20out%20this%20site http%3a%2f%2flocalhost%3a1313%2fblog%2fapache-lucene-tutorial%2f'>
                    <i class="fa fa-envelope"></i>
                  </a>
                </li>
              </ul>
            </div>
          </aside>
          
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12 col-lg-9 p-4">
        
      </div>
    </div>
  </div>
  <button class="p-2 px-3" onclick="topFunction()" id="topScroll">
    <i class="fas fa-angle-up"></i>
  </button>
</section>


<div class="progress">
  <div id="scroll-progress-bar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
</div>
<Script src="/js/scrollProgressBar.js"></script>


<script>
  var topScroll = document.getElementById("topScroll");
  window.onscroll = function() {scrollFunction()};

  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      topScroll.style.display = "block";
    } else {
      topScroll.style.display = "none";
    }
  }

  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }

  
  let stickySideBarElem = document.getElementById("stickySideBar");
  let stickyNavBar =  true ;
  if(stickyNavBar) {
    let headerElem = document.getElementById("profileHeader");
    let headerHeight = headerElem.offsetHeight + 15;
    stickySideBarElem.style.top = headerHeight + "px";
  } else {
    stickySideBarElem.style.top = "50px";
  }
</script>


<script src="/js/readingTime.js"></script>



  </div><footer>
    
 

<div class="text-center pt-2">
    
    <span class="px-1">
        <a href="https://github.com/IshanUpmanyu" aria-label="github">
            <svg xmlns="http://www.w3.org/2000/svg" width="2.7em" height="2.7em" viewBox="0 0 1792 1792">
                <path
                    d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5t-203.5 84.5h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-86-13.5q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5h-224q-119 0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5 84.5t84.5 203.5z" />

                <metadata>
                    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                        xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:dc="http://purl.org/dc/elements/1.1/">
                        <rdf:Description about="https://iconscout.com/legal#licenses"
                            dc:title="Github, Online, Project, Hosting, Square"
                            dc:description="Github, Online, Project, Hosting, Square" dc:publisher="Iconscout"
                            dc:date="2016-12-14" dc:format="image/svg+xml" dc:language="en">
                            <dc:creator>
                                <rdf:Bag>
                                    <rdf:li>Font Awesome</rdf:li>
                                </rdf:Bag>
                            </dc:creator>
                        </rdf:Description>
                    </rdf:RDF>
                </metadata>
            </svg>
        </a>
    </span>
    

    
    <span class="px-1">
        <a href="https://www.linkedin.com/in/ishan-upamanyu-softwaredevelopment/" aria-label="linkedin">
            <svg xmlns="http://www.w3.org/2000/svg" width='2.4em' height='2.4em' fill="#fff" aria-label="LinkedIn"
                viewBox="0 0 512 512">
                <rect width="512" height="512" fill="#0077b5" rx="15%" />
                <circle cx="142" cy="138" r="37" />
                <path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198" />
                <path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32" />
            </svg>
        </a>
    </span>
    

    

    

    
</div><div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-4 text-center">
            <div class="pb-2">
                <a href="http://localhost:1313/" title="Ishan&#39;s Blog">
                    <img alt="Footer logo" src="/fav.png"
                        height="40px" width="40px">
                </a>
            </div>
            &copy; 2024  All rights reserved
            <div class="text-secondary">
                Made with
                <span class="text-danger">
                    &#10084;
                </span>
                and
                <a href="https://github.com/gurusabarish/hugo-profile" target="_blank"
                    title="Designed and developed by gurusabarish">
                    Hugo Profile
                </a>
            </div>
        </div>
    </div>
</div></footer><script src="/bootstrap-5/js/bootstrap.bundle.min.js"></script>
<script>
    if (document.body.className.includes("dark")) {
        document.body.classList.remove('dark');
        localStorage.setItem("pref-theme", 'light');
    }
</script>




    <script src="/js/search.js"></script>





<!-- MathJax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js" integrity="sha384-M5jmNxKC9EVnuqeMwRHvFuYUE8Hhp0TgBruj/GZRkYtiMrCRgH7yvv5KY+Owi7TW" crossorigin="anonymous"></script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['\\(','\\)']],
        displayMath: [['$$','$$'], ['\[','\]']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        TeX: { equationNumbers: { autoNumber: "AMS" },
             extensions: ["AMSmath.js", "AMSsymbols.js"] }
      }
    });
</script>








  <section id="search-content" class="py-2">
    <div class="container" id="search-results"></div>
  </section>
</body>

</html>